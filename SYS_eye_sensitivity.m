function [ V ] = SYS_eye_sensitivity( min, max, CIE )
%SYS_EYE_SENSITIVITY Produces eye sensitivity (luminosity) function
%   Loads in Eye sensitivity values as noted in "Light-Emitting Diodes" by
%   E.F. Schubert - Appendix 16.1.  Intermediate values are approximated.
%   
%   Parameters:
%       min: Minimum wavelength (nm)
%       max: maximum wavelength (nm)
%       CIE: Either 1931 (For the CIE 1930 standard) or 1978 for the
%               modified Judd-Vos curve.

  V = zeros(1, 1+max-min);
  V_1 = 1+360-min;

  %Eye Sensitivity function values from "Light-Emitting Diodes" by
  %E.F. Schubert - Appendix 16.1
  if (CIE == 1931)
    V(V_1) = 3.917e-6;
    V(V_1+5) = 6.965e-6;
    V(V_1+10) = 1.239e-5;
    V(V_1+15) = 2.202e-5;
    V(V_1+20) = 3.9e-5;
    V(V_1+25) = 6.4e-5;
    V(V_1+30) = 1.2e-4;
    V(V_1+35) = 2.17e-4;
    V(V_1+40) = 3.96e-4;
    V(V_1+45) = 6.4e-4;
    V(V_1+50) = 1.21e-3;
    V(V_1+55) = 2.18e-3;
    V(V_1+60) = 4.0e-3;
    V(V_1+65) = 7.3e-3;
    V(V_1+70) = 1.16e-2;
    V(V_1+75) = 1.684e-2;
    V(V_1+80) = 2.3e-2;
    V(V_1+85) = 2.98e-2;
    V(V_1+90) = 3.8e-2;
    V(V_1+95) = 4.8e-2;
    V(V_1+100) = 6.0e-2;
    V(V_1+105) = 7.39e-2;
    V(V_1+110) = 9.098e-2;
    V(V_1+115) = 0.1126;
    V(V_1+120) = 0.13902;
    V(V_1+125) = 0.16930;
    V(V_1+130) = 0.20802;
    V(V_1+135) = 0.25860;
    V(V_1+140) = 0.323;
    V(V_1+145) = 0.4073;
    V(V_1+150) = 0.503;
    V(V_1+155) = 0.6082;
    V(V_1+160) = 0.710;
    V(V_1+165) = 0.7932;
    V(V_1+170) = 0.862;
    V(V_1+175) = 0.91485;
    V(V_1+180) = 0.954;
    V(V_1+185) = 0.9803;
    V(V_1+190) = 0.99495;
    V(V_1+195) = 1.00;
    V(V_1+200) = 0.995;
    V(V_1+205) = 0.9786;
    V(V_1+210) = 0.952;
    V(V_1+215) = 0.9154;
    V(V_1+220) = 0.87;
    V(V_1+225) = 0.8163;
    V(V_1+230) = 0.757;
    V(V_1+235) = 0.6949;
    V(V_1+240) = 0.631;
    V(V_1+245) = 0.5668;
    V(V_1+250) = 0.503;
    V(V_1+255) = 0.4412;
    V(V_1+260) = 0.381;
    V(V_1+265) = 0.321;
    V(V_1+270) = 0.265;
    V(V_1+275) = 0.217;
    V(V_1+280) = 0.175;
    V(V_1+285) = 0.1382;
    V(V_1+290) = 0.107;
    V(V_1+295) = 8.16e-2;
    V(V_1+300) = 6.1e-2;
    V(V_1+305) = 4.458e-2;
    V(V_1+310) = 3.2e-2;
    V(V_1+315) = 2.32e-2;
    V(V_1+320) = 1.7e-2;
    V(V_1+325) = 1.192e-2;
    V(V_1+330) = 8.21e-3;
    V(V_1+335) = 5.723e-3;
    V(V_1+340) = 4.102e-3;
    V(V_1+345) = 2.929e-3;
    V(V_1+350) = 2.091e-3;
    V(V_1+355) = 1.484e-3;
    V(V_1+360) = 1.047e-3;
    V(V_1+365) = 7.4e-4;
    V(V_1+370) = 5.2e-4;
    V(V_1+375) = 3.611e-4;
    V(V_1+380) = 2.492e-4;
    V(V_1+385) = 1.719e-4;
    V(V_1+390) = 1.2e-4;
    V(V_1+395) = 8.48e-5;
    V(V_1+400) = 6.0e-5;
    V(V_1+405) = 4.24e-5;
    V(V_1+410) = 3.0e-5;
    V(V_1+415) = 2.12e-5;
    V(V_1+420) = 1.499e-5;
    V(V_1+425) = 1.06e-5;
    V(V_1+430) = 7.4657e-6;
    V(V_1+435) = 5.2578e-6;
    V(V_1+440) = 3.7029e-6;
    V(V_1+445) = 2.6078e-6;
    V(V_1+450) = 1.8366e-6;
    V(V_1+455) = 1.2934e-6;
    V(V_1+460) = 9.1093e-7;
    V(V_1+465) = 6.4153e-7;
    
    
  elseif (CIE == 1978)
    V(V_1) = 0;
    V(V_1+5) = 0;
    V(V_1+10) = 0;
    V(V_1+15) = 0;
    V(V_1+20) = 2e-4;
    V(V_1+25) = 3.9556e-4;
    V(V_1+30) = 8.0e-4;
    V(V_1+35) = 1.5457e-3;
    V(V_1+40) = 2.8e-3;
    V(V_1+45) = 4.6562e-3;
    V(V_1+50) = 7.4e-3;
    V(V_1+55) = 1.1779e-2;
    V(V_1+60) = 1.75e-2;
    V(V_1+65) = 2.267e-2;
    V(V_1+70) = 2.73e-2;
    V(V_1+75) = 3.2584e-2;
    V(V_1+80) = 3.79e-2;
    V(V_1+85) = 4.2391e-2;
    V(V_1+90) = 4.68e-2;
    V(V_1+95) = 5.2122e-2;
    V(V_1+100) =6.0e-2;
    V(V_1+105) = 7.2942e-2;
    V(V_1+110) = 9.098e-2;
    V(V_1+115) = 0.11284;
    V(V_1+120) = 0.13902;
    V(V_1+125) = 0.16987;
    V(V_1+130) = 0.20802;
    V(V_1+135) = 0.25808;
    V(V_1+140) = 0.323;
    V(V_1+145) = 0.4054;
    V(V_1+150) = 0.503;
    V(V_1+155) = 0.60811;
    V(V_1+160) = 0.71;
    V(V_1+165) = 0.7951;
    V(V_1+170) = 0.862;
    V(V_1+175) = 0.91505;
    V(V_1+180) = 0.954;
    V(V_1+185) = 0.98004;
    V(V_1+190) = 0.99495;
    V(V_1+195) = 1.00;
    V(V_1+200) = 0.995;
    V(V_1+205) = 0.97875;
    V(V_1+210) = 0.952;
    V(V_1+215) = 0.91558;
    V(V_1+220) = 0.87;
    V(V_1+225) = 0.81623;
    V(V_1+230) = 0.757;
    V(V_1+235) = 0.69483;
    V(V_1+240) = 0.631;
    V(V_1+245) = 0.56654;
    V(V_1+250) = 0.503;
    V(V_1+255) = 0.44172;
    V(V_1+260) = 0.381;
    V(V_1+265) = 0.32052;
    V(V_1+270) = 0.265;
    V(V_1+275) = 0.21702;
    V(V_1+280) = 0.175;
    V(V_1+285) = 0.13812;
    V(V_1+290) = 0.107;
    V(V_1+295) = 8.1652e-2;
    V(V_1+300) = 6.1e-2;
    V(V_1+305) = 4.4327e-2;
    V(V_1+310) = 3.2e-2;
    V(V_1+315) = 2.3454e-2;
    V(V_1+320) = 1.7e-2;
    V(V_1+325) = 1.1872e-2;
    V(V_1+330) = 8.21e-3;
    V(V_1+335) = 5.7723e-3;
    V(V_1+340) = 4.102e-3;
    V(V_1+345) = 2.9291e-3;
    V(V_1+350) = 2.091e-3;
    V(V_1+355) = 1.4822e-3;
    V(V_1+360) = 1.047e-3;
    V(V_1+365) = 7.4015e-4;
    V(V_1+370) = 5.2e-4;
    V(V_1+375) = 3.6093e-4;
    V(V_1+380) = 2.492e-4;
    V(V_1+385) = 1.7231e-4;
    V(V_1+390) = 1.2e-4;
    V(V_1+395) = 8.462e-5;
    V(V_1+400) = 6.0e-5;
    V(V_1+405) = 4.2446e-5;
    V(V_1+410) = 3.0e-5;
    V(V_1+415) = 2.121e-5;
    V(V_1+420) = 1.4989e-5;
    V(V_1+425) = 1.0584e-5;
    V(V_1+430) = 7.4656e-6;
    V(V_1+435) = 5.2592e-6;
    V(V_1+440) = 3.7028e-6;
    V(V_1+445) = 2.6076e-6;
    V(V_1+450) = 1.8365e-6;
    V(V_1+455) = 1.2950e-6;
    V(V_1+460) = 9.1092e-7;
    V(V_1+465) = 6.3564e-7;
  end


  %Approximate other values
  for i=1:5:(max-min)
    diff = abs(V(i) - V(i+5));
    if (V(i+5) > V(i))
        V(i+1) = V(i) + diff/5;
        V(i+2) = V(i) + 2*diff/5;
        V(i+3) = V(i) + 3*diff/5;
        V(i+4) = V(i) + 4*diff/5;
    else
        V(i+1) = V(i) - diff/5;
        V(i+2) = V(i) - 2*diff/5;
        V(i+3) = V(i) - 3*diff/5;
        V(i+4) = V(i) - 4*diff/5;    
    end

  end
  
  V = V(1:1+max-min);

end %END func_eye_sensitivity()

